# üîê –û–¢–ß–ï–¢ –ü–û –ê–ù–ê–õ–ò–ó–£ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò MY-PASSWORDS

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 25.09.2024  
**–ê–Ω–∞–ª–∏—Ç–∏–∫:** Kilo Code  
**–°—Ç–∞—Ç—É—Å:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò –û–ë–ù–ê–†–£–ñ–ï–ù–´  

---

## üìä –†–ï–ó–Æ–ú–ï –ê–ù–ê–õ–ò–ó–ê

### ‚úÖ –ü–û–õ–û–ñ–ò–¢–ï–õ–¨–ù–´–ï –ê–°–ü–ï–ö–¢–´:
- **–ú–∞—Å—Ç–µ—Ä-–ø–∞—Ä–æ–ª—å –ù–ï –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä** - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–æ–±–ª—é–¥–µ–Ω–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ WebAuthn –¥–ª—è –±–∏–æ–º–µ—Ç—Ä–∏–∏
- AES —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –î–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Å–µ—Å—Å–∏–π (1 —á–∞—Å)

### üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –†–ò–°–ö: 
**8 —Å–µ—Ä—å–µ–∑–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ**, –≤–∫–ª—é—á–∞—è –ø–æ–ª–Ω—É—é –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—é –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

---

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò

### 1. –ü–û–õ–ù–ê–Ø –ö–û–ú–ü–†–û–ú–ï–¢–ê–¶–ò–Ø –ë–ò–û–ú–ï–¢–†–ò–ß–ï–°–ö–û–ô –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–ò
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô üî¥  
**–§–∞–π–ª:** `backend/src/handlers/biometric/authenticate.ts:40`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ WebAuthn cryptographic signature  

```javascript
// –¢–ï–ö–£–©–ò–ô –ö–û–î (–£–Ø–ó–í–ò–ú–´–ô):
// TODO: –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ WebAuthn assertion
// –î–ª—è MVP —É–ø—Ä–æ—â–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É - —Å—á–∏—Ç–∞–µ–º —á—Ç–æ –µ—Å–ª–∏ credential –Ω–∞–π–¥–µ–Ω, —Ç–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
```

**–ê—Ç–∞–∫–∞:** –õ—é–±–æ–π –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –ø–æ–¥–¥–µ–ª–∞—Ç—å –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, –∑–Ω–∞—è —Ç–æ–ª—å–∫–æ `credentialId`.

**–¢–†–ï–ë–û–í–ê–ù–ò–Ø –î–õ–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:**
```javascript
// 1. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–¥–ø–∏—Å–∏:
const isValidSignature = await verifyWebAuthnSignature({
    signature: authData.signature,
    publicKey: credential.publicKey,
    challenge: storedChallenge,
    clientDataJSON: authData.clientDataJSON,
    authenticatorData: authData.authenticatorData
});

// 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ challenge:
const clientData = JSON.parse(Buffer.from(clientDataJSON, 'base64').toString());
if (clientData.challenge !== storedChallenge) {
    throw new Error('Invalid challenge');
}

// 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ origin:
if (clientData.origin !== expectedOrigin) {
    throw new Error('Invalid origin');
}

// 4. Counter –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è replay protection
if (authenticatorData.counter <= credential.counter) {
    throw new Error('Invalid counter - possible replay attack');
}
```

### 2. –°–õ–ê–ë–û–ï –®–ò–§–†–û–í–ê–ù–ò–ï –ú–ê–°–¢–ï–†-–ü–ê–†–û–õ–Ø
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í–´–°–û–ö–ò–ô üü†  
**–§–∞–π–ª:** `frontend/src/encryption/keyDerivation.ts:35-40`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–≥–æ XOR —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è  

```javascript
// –¢–ï–ö–£–©–ò–ô –ö–û–î (–£–Ø–ó–í–ò–ú–´–ô):
const encrypted = Array.from(masterPassword)
    .map((char, i) => String.fromCharCode(
        char.charCodeAt(0) ^ storageKey.charCodeAt(i % storageKey.length)
    ))
    .join('')
```

**–¢–†–ï–ë–û–í–ê–ù–ò–Ø –î–õ–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:**
```javascript
import { AES, enc, mode, pad, PBKDF2, lib } from 'crypto-js';

export function encryptMasterPasswordSecurely(masterPassword: string, credentialId: string): string {
    // 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–π —Å–æ–ª–∏
    const salt = lib.WordArray.random(256/8);
    
    // 2. –î–µ—Ä–∏–≤–∞—Ü–∏—è –∫–ª—é—á–∞ —Å PBKDF2
    const key = PBKDF2(credentialId + 'master-key-2024', salt, {
        keySize: 256/32,
        iterations: 100000
    });
    
    // 3. AES-GCM —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
    const encrypted = AES.encrypt(masterPassword, key, {
        mode: mode.GCM,
        padding: pad.Pkcs7
    });
    
    // 4. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å–æ–ª–∏ –∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    return salt.toString() + ':' + encrypted.toString();
}

export function decryptMasterPasswordSecurely(encryptedData: string, credentialId: string): string {
    const [saltStr, encryptedStr] = encryptedData.split(':');
    const salt = enc.Hex.parse(saltStr);
    
    const key = PBKDF2(credentialId + 'master-key-2024', salt, {
        keySize: 256/32,
        iterations: 100000
    });
    
    const decrypted = AES.decrypt(encryptedStr, key, {
        mode: mode.GCM,
        padding: pad.Pkcs7
    });
    
    return decrypted.toString(enc.Utf8);
}
```

### 3. –ù–ï–ë–ï–ó–û–ü–ê–°–ù–û–ï –•–†–ê–ù–ï–ù–ò–ï –í LOCALSTORAGE
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í–´–°–û–ö–ò–ô üü†  
**–§–∞–π–ª:** `frontend/src/api/biometric.ts:146`  
**–ü—Ä–æ–±–ª–µ–º–∞:** localStorage –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è XSS –∞—Ç–∞–∫  

**–¢–†–ï–ë–û–í–ê–ù–ò–Ø –î–õ–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:**
```javascript
// –ó–∞–º–µ–Ω–∏—Ç—å localStorage –Ω–∞ IndexedDB —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º
class SecureStorage {
    private dbName = 'my-passwords-secure';
    private version = 1;
    
    async storeEncryptedData(key: string, encryptedData: string, deviceKey: string): Promise<void> {
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ IndexedDB
        const doubleEncrypted = await this.encryptWithDeviceKey(encryptedData, deviceKey);
        
        const db = await this.openDB();
        const transaction = db.transaction(['secure_store'], 'readwrite');
        const store = transaction.objectStore('secure_store');
        
        await store.put({ id: key, data: doubleEncrypted, timestamp: Date.now() });
    }
    
    private async encryptWithDeviceKey(data: string, deviceKey: string): Promise<string> {
        // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Web Crypto API –¥–ª—è additional layer encryption
        const key = await window.crypto.subtle.importKey(
            'raw',
            new TextEncoder().encode(deviceKey),
            { name: 'AES-GCM' },
            false,
            ['encrypt']
        );
        
        const iv = window.crypto.getRandomValues(new Uint8Array(12));
        const encrypted = await window.crypto.subtle.encrypt(
            { name: 'AES-GCM', iv },
            key,
            new TextEncoder().encode(data)
        );
        
        return JSON.stringify({
            iv: Array.from(iv),
            data: Array.from(new Uint8Array(encrypted))
        });
    }
}
```

---

## üü† –í–´–°–û–ö–ò–ô –†–ò–°–ö

### 4. –û–¢–°–£–¢–°–¢–í–ò–ï –°–û–õ–ò –í AES –®–ò–§–†–û–í–ê–ù–ò–ò
**–§–∞–π–ª:** `frontend/src/encryption/toEncrypt.ts:9`  
**–ü—Ä–æ–±–ª–µ–º–∞:** AES –±–µ–∑ —Å–ª—É—á–∞–π–Ω–æ–π —Å–æ–ª–∏  

**–¢–†–ï–ë–û–í–ê–ù–ò–Ø:**
```javascript
import { AES, lib, PBKDF2 } from 'crypto-js';

export function toEncrypt(data: string, password: string): string {
    let result = data;
    
    for (let i = 0; i < config.count; i++) {
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–π —Å–æ–ª–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
        const salt = lib.WordArray.random(256/8);
        
        // –î–µ—Ä–∏–≤–∞—Ü–∏—è –∫–ª—é—á–∞ —Å —Å–æ–ª—å—é
        const key = PBKDF2(password, salt, {
            keySize: 256/32,
            iterations: 10000
        });
        
        // –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å IV
        const iv = lib.WordArray.random(128/8);
        const encrypted = AES.encrypt(result, key, { iv });
        
        // –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å–æ–ª–∏, IV –∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        result = salt.toString() + ':' + iv.toString() + ':' + encrypted.toString();
    }
    
    return result;
}
```

---

## üü° –°–†–ï–î–ù–ò–ô –†–ò–°–ö

### 5. –°–õ–ê–ë–´–ô –ì–ï–ù–ï–†–ê–¢–û–† SESSIONID
**–§–∞–π–ª:** `backend/src/middlewares/authorization/utils.ts:44-47`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Math.random()  

**–¢–†–ï–ë–û–í–ê–ù–ò–Ø:**
```javascript
import { randomBytes } from 'crypto';

export function generateSessionId(): string {
    // –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
    const randomId = randomBytes(32).toString('hex');
    const timestamp = Date.now().toString(36);
    
    return `${timestamp}-${randomId}`;
}
```

### 6. –ù–ï–ë–ï–ó–û–ü–ê–°–ù–û–ï –§–ê–ô–õ–û–í–û–ï –•–†–ê–ù–ò–õ–ò–©–ï
**–§–∞–π–ª—ã:** `backend/src/store.ts`, `backend/src/biometricStore.ts`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –î–∞–Ω–Ω—ã–µ –≤ plain text —Ñ–∞–π–ª–∞—Ö  

**–¢–†–ï–ë–û–í–ê–ù–ò–Ø:**
```javascript
import { createCipher, createDecipher } from 'crypto';
import { readFileSync, writeFileSync } from 'fs';

class EncryptedFileStore {
    private encryptionKey: string;
    
    constructor() {
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
        this.encryptionKey = process.env.FILE_ENCRYPTION_KEY || 'default-key-change-me';
    }
    
    writeEncrypted(filePath: string, data: string): void {
        const cipher = createCipher('aes-256-cbc', this.encryptionKey);
        let encrypted = cipher.update(data, 'utf8', 'hex');
        encrypted += cipher.final('hex');
        
        writeFileSync(filePath, encrypted, { encoding: 'utf8', mode: 0o600 });
    }
    
    readEncrypted(filePath: string): string {
        const encryptedData = readFileSync(filePath, { encoding: 'utf8' });
        const decipher = createDecipher('aes-256-cbc', this.encryptionKey);
        let decrypted = decipher.update(encryptedData, 'hex', 'utf8');
        decrypted += decipher.final('utf8');
        
        return decrypted;
    }
}
```

### 7. –ü–ï–†–ï–î–ê–ß–ê –î–ê–ù–ù–´–• –í TELEGRAM
**–§–∞–π–ª:** `backend/src/handlers/passwords/post.ts:12`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Ç—Ä–µ—Ç—å–µ–π —Å—Ç–æ—Ä–æ–Ω–µ  

**–¢–†–ï–ë–û–í–ê–ù–ò–Ø:**
1. **–û–¢–ö–õ–Æ–ß–ò–¢–¨** –æ—Ç–ø—Ä–∞–≤–∫—É –≤ Telegram –¥–ª—è production
2. –ï—Å–ª–∏ backup –Ω–µ–æ–±—Ö–æ–¥–∏–º - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–µ encrypted storage
3. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è Telegram —Ñ—É–Ω–∫—Ü–∏–∏

```javascript
// .env
ENABLE_TELEGRAM_BACKUP=false

// post.ts
export function postPasswords(req: Request, res: Response) {
    const requestData = req.body.data;
    const data = JSON.stringify(requestData, null, 4);
    
    writeStore(data);
    
    // –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram —Ç–æ–ª—å–∫–æ –≤ dev —Ä–µ–∂–∏–º–µ
    if (process.env.ENABLE_TELEGRAM_BACKUP === 'true' && process.env.NODE_ENV !== 'production') {
        sendTelegramFile(data);
    }
    
    res.sendStatus(200);
}
```

---

## üü¢ –ù–ò–ó–ö–ò–ô –†–ò–°–ö

### 8. –û–¢–°–£–¢–°–¢–í–ò–ï RATE LIMITING
**–§–∞–π–ª—ã:** –í—Å–µ API endpoints  

**–¢–†–ï–ë–û–í–ê–ù–ò–Ø:**
```javascript
import rateLimit from 'express-rate-limit';

// Rate limiting –¥–ª—è –∫–æ–¥–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
const authCodeLimit = rateLimit({
    windowMs: 15 * 60 * 1000, // 15 –º–∏–Ω—É—Ç
    max: 5, // –º–∞–∫—Å–∏–º—É–º 5 –∑–∞–ø—Ä–æ—Å–æ–≤ –∫–æ–¥–æ–≤ –∑–∞ 15 –º–∏–Ω—É—Ç
    message: '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫–æ–¥–æ–≤, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ',
    standardHeaders: true,
    legacyHeaders: false,
});

// Rate limiting –¥–ª—è –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
const biometricLimit = rateLimit({
    windowMs: 1 * 60 * 1000, // 1 –º–∏–Ω—É—Ç–∞
    max: 10, // –º–∞–∫—Å–∏–º—É–º 10 –ø–æ–ø—ã—Ç–æ–∫ –∑–∞ –º–∏–Ω—É—Ç—É
    message: '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫ –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏',
});
```

---

## üõ°Ô∏è –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–û –ü–†–ò–û–†–ò–¢–ï–¢–ê–ú

### –ù–ï–ú–ï–î–õ–ï–ù–ù–û (–í –¢–ï–ß–ï–ù–ò–ï 1 –î–ù–Ø):
- [ ] **–ò—Å–ø—Ä–∞–≤–∏—Ç—å WebAuthn –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–¥–ø–∏—Å–∏** - —Ñ–∞–π–ª `backend/src/handlers/biometric/authenticate.ts`
- [ ] **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É challenge, origin, counter** –≤ –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –í –¢–ï–ß–ï–ù–ò–ï –ù–ï–î–ï–õ–ò:
- [ ] **–ó–∞–º–µ–Ω–∏—Ç—å XOR –Ω–∞ AES-GCM** - —Ñ–∞–π–ª `frontend/src/encryption/keyDerivation.ts`
- [ ] **–ó–∞–º–µ–Ω–∏—Ç—å localStorage –Ω–∞ IndexedDB** - —Ñ–∞–π–ª `frontend/src/api/biometric.ts`
- [ ] **–î–æ–±–∞–≤–∏—Ç—å —Å–æ–ª—å –≤ AES —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** - —Ñ–∞–π–ª `frontend/src/encryption/toEncrypt.ts`
- [ ] **–û—Ç–∫–ª—é—á–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –≤ Telegram** - —Ñ–∞–π–ª `backend/src/handlers/passwords/post.ts`

### –í –¢–ï–ß–ï–ù–ò–ï –ú–ï–°–Ø–¶–ê:
- [ ] **–ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–π sessionId** - —Ñ–∞–π–ª `backend/src/middlewares/authorization/utils.ts`
- [ ] **–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ñ–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ** - —Ñ–∞–π–ª—ã `backend/src/store.ts`, `backend/src/biometricStore.ts`
- [ ] **Rate limiting** - –≤—Å–µ API endpoints
- [ ] **CSRF protection –∏ secure cookies**

---

## üîç –ß–ï–ö–õ–ò–°–¢ –î–õ–Ø –ü–†–û–í–ï–†–ö–ò –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –ë–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ WebAuthn signature —Å –ø—É–±–ª–∏—á–Ω—ã–º –∫–ª—é—á–æ–º
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è challenge –∏–∑ clientDataJSON
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ origin –≤ clientDataJSON
- [ ] Counter –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è replay protection
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ counter –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:
- [ ] AES-GCM –≤–º–µ—Å—Ç–æ XOR –¥–ª—è –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä–æ–ª—è
- [ ] –°–ª—É—á–∞–π–Ω–∞—è —Å–æ–ª—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- [ ] PBKDF2 —Å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏—Ç–µ—Ä–∞—Ü–∏–π (100,000+)
- [ ] Web Crypto API –¥–ª—è additional layer

### –•—Ä–∞–Ω–µ–Ω–∏–µ:
- [ ] IndexedDB –≤–º–µ—Å—Ç–æ localStorage
- [ ] –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–∞ –±—ç–∫–µ–Ω–¥–µ
- [ ] –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º (0o600)
- [ ] Secure cookies (httpOnly, secure, sameSite)

### –°–µ—Å—Å–∏–∏:
- [ ] –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–π sessionId
- [ ] Rate limiting –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ endpoints
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏—Å—Ç–µ–∫—à–∏—Ö —Å–µ—Å—Å–∏–π
- [ ] CSRF —Ç–æ–∫–µ–Ω—ã

---

## üìû –ö–û–ù–¢–ê–ö–¢–´ –î–õ–Ø –ö–û–ù–°–£–õ–¨–¢–ê–¶–ò–ô

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫:
- **–ê–Ω–∞–ª–∏—Ç–∏–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** Kilo Code
- **–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—á–µ—Ç–∞:** 25.09.2024
- **–°–ª–µ–¥—É—é—â–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:** –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

---

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –î–∞–Ω–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–µ—Ä—å–µ–∑–Ω—É—é —É–≥—Ä–æ–∑—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –û—Å–æ–±–µ–Ω–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π - –æ–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–æ–π—Ç–∏ –∑–∞—â–∏—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.