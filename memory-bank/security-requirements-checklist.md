# üö® –ß–ï–ö–õ–ò–°–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –£–Ø–ó–í–ò–ú–û–°–¢–ï–ô MY-PASSWORDS

**–°—Ç–∞—Ç—É—Å:** –ê–ö–¢–ò–í–ù–´–ï –ó–ê–î–ê–ß–ò  
**–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 25.09.2024  

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (–ù–ï–ú–ï–î–õ–ï–ù–ù–û)

### ‚úÖ –ë–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è - –ü–û–õ–ù–ê–Ø –ö–û–ú–ü–†–û–ú–ï–¢–ê–¶–ò–Ø
**–§–∞–π–ª:** `backend/src/handlers/biometric/authenticate.ts`  
**–ó–∞–¥–∞—á–∞:** –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É WebAuthn  
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –ò–°–ü–†–ê–í–õ–ï–ù–û  

**–î–µ–π—Å—Ç–≤–∏—è:**
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É cryptographic signature
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è challenge –∏–∑ clientDataJSON  
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ origin –≤ clientDataJSON
- [ ] Counter –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è replay protection
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ counter –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–ö–æ–¥ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```javascript
// –î–æ–±–∞–≤–∏—Ç—å –≤ authenticate.ts –ø–µ—Ä–µ–¥ —Å—Ç—Ä–æ–∫–æ–π 40:
const isValidSignature = await verifyWebAuthnSignature({
    signature: authData.signature,
    publicKey: credential.publicKey,
    challenge: storedChallenge,
    clientDataJSON: authData.clientDataJSON,
    authenticatorData: authData.authenticatorData
});

if (!isValidSignature) {
    res.status(403).json({ error: "–ù–µ–≤–µ—Ä–Ω–∞—è –ø–æ–¥–ø–∏—Å—å WebAuthn" });
    return;
}
```

---

## üü† –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (–í –¢–ï–ß–ï–ù–ò–ï –ù–ï–î–ï–õ–ò)

### ‚úÖ –°–ª–∞–±–æ–µ XOR —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä–æ–ª—è
**–§–∞–π–ª:** `frontend/src/encryption/keyDerivation.ts`  
**–ó–∞–¥–∞—á–∞:** –ó–∞–º–µ–Ω–∏—Ç—å XOR –Ω–∞ AES-GCM  
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –ò–°–ü–†–ê–í–õ–ï–ù–û  

**–î–µ–π—Å—Ç–≤–∏—è:**
- [ ] –ó–∞–º–µ–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ `encryptMasterPasswordLocally` –∏ `decryptMasterPasswordLocally`
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AES-GCM —Å —Å–ª—É—á–∞–π–Ω–æ–π —Å–æ–ª—å—é
- [ ] –î–æ–±–∞–≤–∏—Ç—å PBKDF2 —Å 100,000 –∏—Ç–µ—Ä–∞—Ü–∏–π

### ‚úÖ –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ localStorage —Ö—Ä–∞–Ω–µ–Ω–∏–µ
**–§–∞–π–ª:** `frontend/src/api/biometric.ts`  
**–ó–∞–¥–∞—á–∞:** –ó–∞–º–µ–Ω–∏—Ç—å localStorage –Ω–∞ IndexedDB  
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –ò–°–ü–†–ê–í–õ–ï–ù–û  

**–î–µ–π—Å—Ç–≤–∏—è:**
- [ ] –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å SecureStorage —Å IndexedDB
- [ ] –î–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Web Crypto API
- [ ] –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ –≤—ã–∑–æ–≤—ã localStorage

### ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–æ–ª–∏ –≤ AES
**–§–∞–π–ª:** `frontend/src/encryption/toEncrypt.ts`  
**–ó–∞–¥–∞—á–∞:** –î–æ–±–∞–≤–∏—Ç—å —Å–ª—É—á–∞–π–Ω—É—é —Å–æ–ª—å  
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –ò–°–ü–†–ê–í–õ–ï–ù–û  

**–î–µ–π—Å—Ç–≤–∏—è:**
- [ ] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–π —Å–æ–ª–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PBKDF2 –¥–ª—è –¥–µ—Ä–∏–≤–∞—Ü–∏–∏ –∫–ª—é—á–∞
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ IV –¥–ª—è AES

### ‚úÖ –û—Ç–∫–ª—é—á–∏—Ç—å Telegram backup
**–§–∞–π–ª:** `backend/src/handlers/passwords/post.ts`  
**–ó–∞–¥–∞—á–∞:** –£–±—Ä–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –¥–∞–Ω–Ω—ã—Ö –≤ Telegram  
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –ò–°–ü–†–ê–í–õ–ï–ù–û  

**–î–µ–π—Å—Ç–≤–∏—è:**
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è ENABLE_TELEGRAM_BACKUP=false
- [ ] –£—Å–ª–æ–≤–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç–æ–ª—å–∫–æ –≤ dev —Ä–µ–∂–∏–º–µ
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∏—Å–∫–∏ Telegram backup

---

## üü° –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (–í –¢–ï–ß–ï–ù–ò–ï –ú–ï–°–Ø–¶–ê)

### ‚úÖ –°–ª–∞–±—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä sessionId
**–§–∞–π–ª:** `backend/src/middlewares/authorization/utils.ts`  
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –ò–°–ü–†–ê–í–õ–ï–ù–û  

**–î–µ–π—Å—Ç–≤–∏—è:**
- [ ] –ó–∞–º–µ–Ω–∏—Ç—å Math.random() –Ω–∞ crypto.randomBytes()
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 32 –±–∞–π—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- [ ] –î–æ–±–∞–≤–∏—Ç—å timestamp –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏

### ‚úÖ –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ñ–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
**–§–∞–π–ª—ã:** `backend/src/store.ts`, `backend/src/biometricStore.ts`  
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –ò–°–ü–†–ê–í–õ–ï–ù–û  

**–î–µ–π—Å—Ç–≤–∏—è:**
- [ ] –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å EncryptedFileStore
- [ ] –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ AES-256-CBC
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ 0o600
- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

### ‚úÖ Rate limiting
**–§–∞–π–ª—ã:** –í—Å–µ API endpoints  
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –ò–°–ü–†–ê–í–õ–ï–ù–û  

**–î–µ–π—Å—Ç–≤–∏—è:**
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å express-rate-limit
- [ ] 5 –∑–∞–ø—Ä–æ—Å–æ–≤ –∫–æ–¥–æ–≤ –∑–∞ 15 –º–∏–Ω—É—Ç
- [ ] 10 –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö –ø–æ–ø—ã—Ç–æ–∫ –∑–∞ –º–∏–Ω—É—Ç—É
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### ‚úÖ CSRF protection
**–§–∞–π–ª—ã:** –í—Å–µ —Ñ–æ—Ä–º—ã –∏ API  
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –ò–°–ü–†–ê–í–õ–ï–ù–û  

**–î–µ–π—Å—Ç–≤–∏—è:**
- [ ] –î–æ–±–∞–≤–∏—Ç—å CSRF —Ç–æ–∫–µ–Ω—ã
- [ ] Secure cookies (httpOnly, secure, sameSite)
- [ ] Content Security Policy headers

---

## üìã –°–¢–ê–¢–£–° –í–´–ü–û–õ–ù–ï–ù–ò–Ø

### –û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å: 0/8 –∑–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (0%)

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Ä–∏—Å–∫:** 1/1 ‚ùå  
**–í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫:** 0/4 ‚ùå  
**–°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫:** 0/3 ‚ùå  

---

## üîß –ë–´–°–¢–†–´–ï –ö–û–ú–ê–ù–î–´ –î–õ–Ø –†–ê–ó–†–ê–ë–û–¢–ß–ò–ö–ê

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
```bash
# Backend
npm install express-rate-limit helmet cors

# Frontend  
npm install @types/crypto-js
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env):
```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ backend/.env
FILE_ENCRYPTION_KEY=your-secure-encryption-key-here
ENABLE_TELEGRAM_BACKUP=false
NODE_ENV=production
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
npm run test:security

# –ü—Ä–æ–≤–µ—Ä–∫–∞ WebAuthn
curl -X POST localhost:3000/api/biometric/authenticate \
  -H "Content-Type: application/json" \
  -d '{"data":{"credentialId":"test","signature":"invalid"}}'
```

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ù–ê–ü–û–ú–ò–ù–ê–ù–ò–Ø

1. **–ù–ï –î–ï–ü–õ–û–ò–¢–¨** –ø–æ–∫–∞ –Ω–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
2. **–û–¢–ö–õ–Æ–ß–ò–¢–¨ TELEGRAM** backup –≤ production –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ  
3. **–°–û–ó–î–ê–¢–¨ BACKUP** –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
4. **–ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–¢–¨** –∫–∞–∂–¥–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ dev –æ–∫—Ä—É–∂–µ–Ω–∏–∏
5. **–ü–†–û–í–ï–°–¢–ò –ü–û–í–¢–û–†–ù–´–ô –ê–£–î–ò–¢** –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

---

## üìû –ö–û–ù–¢–ê–ö–¢–´

**–í–æ–ø—Ä–æ—Å—ã –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º:** Kilo Code  
**–ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç:** `memory-bank/security-audit-report.md`  
**–î–∞—Ç–∞ —Å–ª–µ–¥—É—é—â–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:** –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π